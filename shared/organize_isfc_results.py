
import os
import shutil
import glob

# Config
BASE_DIR = "/Users/tongshan/Documents/TemporalIntegration/result/ISFC/bootstrap"

# Mapping from filename seed string to Folder Name
# Based on README coordinates
SEED_MAP = {
    "seed0_-53_2_r5": "PMC",
    "seed-63_-42_9_r5": "LpSTS",
    "seed57_-31_5_r5": "RpSTS"
}

def organize():
    # We look specifically in the tfce/loo and tfce/pairwise folders as generated by the pipeline
    targets = [
        os.path.join(BASE_DIR, "tfce", "loo"),
        os.path.join(BASE_DIR, "tfce", "pairwise")
    ]
    
    print(f"Organizing results in: {BASE_DIR}")
    
    for target_dir in targets:
        if not os.path.exists(target_dir):
            print(f"Directory not found: {target_dir}")
            continue
            
        print(f"\nProcessing {target_dir}...")
        
        # List all files (not directories)
        files = [f for f in glob.glob(os.path.join(target_dir, "*")) if os.path.isfile(f)]
        
        count = 0
        for f in files:
            filename = os.path.basename(f)
            
            # Identify seed
            matched_name = None
            for seed_str, folder_name in SEED_MAP.items():
                if seed_str in filename:
                    matched_name = folder_name
                    break
            
            if matched_name:
                # Create subfolder: e.g. .../loo/PMC
                seed_dir = os.path.join(target_dir, matched_name)
                os.makedirs(seed_dir, exist_ok=True)
                
                # Move file
                dest = os.path.join(seed_dir, filename)
                shutil.move(f, dest)
                # print(f"  Moved {filename} -> {matched_name}/")
                count += 1
            else:
                # print(f"  Skipping {filename} (No matching seed)")
                pass
                
        print(f"Moved {count} files.")

if __name__ == "__main__":
    organize()
